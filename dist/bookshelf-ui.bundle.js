webpackJsonp([0],{"./src/index.js":function(o,e,r){"use strict";r("./src/styles/main.scss"),r("./src/scripts/zoobooks.js");r("./src/scripts/addBookToLibrary.service.js"),r("./src/scripts/dom.service.js"),r("./src/scripts/loader.service.js"),r("./src/scripts/alert.service.js"),r("./src/scripts/events.service.js");r("./src/scripts/main.js")},"./src/scripts/addBookToDOM.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.addBookToDOM=void 0;var t=r("./src/scripts/deleteBookFromLibrary.service.js");e.addBookToDOM=function(o){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isNew:!1},r=document.querySelector("books"),s=document.querySelector("#bookTemplate"),n=s.cloneNode(!0),i=(n.querySelector("[isbn]"),n.querySelector("[title]")),a=n.querySelector("[authors]"),c=n.querySelector("[category]"),l=(n.querySelector("[thumbnailanchor]"),n.querySelector("[thumbnail]")),d=(n.querySelector("[description]"),n.querySelector("[delete]"));n.removeAttribute("template"),"N/A"!=o.google_thumbnail?l.setAttribute("src",o.google_thumbnail):l.classList.add("missing"),i.innerHTML=o.title,a.innerHTML=o.authors.map(function(o){return o.name}).join(", "),c.innerHTML=o.category,n.id=o.isbn,d.setAttribute("isbn",o.isbn),d.addEventListener("click",function(){var o=this.getAttribute("isbn");(0,t.deleteBookFromLibrary)(o)}),r.appendChild(n),e.isNew&&(n.classList.add("new"),window.scroll(0,document.body.scrollHeight))}},"./src/scripts/addBookToLibrary.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.addBookToLibrary=void 0;var t=r("./src/scripts/http.service.js"),s=r("./src/scripts/alert.service.js"),n=r("./src/scripts/addBookToDOM.service.js"),i=r("./src/scripts/dom.service.js");e.addBookToLibrary=function(o){var e=!0,r=!0,a=!1,c=void 0;try{for(var l,d=Array.from(zoobooks().elements().forms.addBook.form.elements)[Symbol.iterator]();!(r=(l=d.next()).done);r=!0){var u=l.value;if(console.log("formControl.value",u.name,u.value),!u.value){(0,s.alertService)().raise({key:"VALUE_REQUIRED_FOR "+u.name}),alert("VALUE_REQUIRED_FOR "+u.name),e=!1;break}o.volumeInfo[u.name]=u.value}}catch(o){a=!0,c=o}finally{try{!r&&d.return&&d.return()}finally{if(a)throw c}}e&&(console.log(o.volumeInfo),(0,t.$http)("POST","https://zoobooks-api.herokuapp.com/add_book",JSON.stringify(o.volumeInfo)).then(function(o){var e=JSON.parse(o);e.title?((0,n.addBookToDOM)(e,{isNew:!0}),(0,i.headerMenuToggle)(),(0,s.alertService)().raise({key:e.title+" added to library"})):(0,s.alertService)().raise({key:o})},function(o){console.error(o)}))}},"./src/scripts/alert.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.alertService=function(){return function(){return{raise:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{key:"GENERIC_ERROR",msg:""};console.warn("ALERT => "+o.key)}}}}()},"./src/scripts/ctrls.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ctrlsService=function(){return function(){return{disable:function(o){o.setAttribute("disabled","disabled")},enable:function(o){o.removeAttribute("disabled")}}}}()},"./src/scripts/deleteBookFromDom.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.deleteBookFromDOM=function(o){var e=document.getElementById(o);e&&e.parentNode.removeChild(e)}},"./src/scripts/deleteBookFromLibrary.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deleteBookFromLibrary=void 0;var t=r("./src/scripts/http.service.js"),s=r("./src/scripts/alert.service.js"),n=r("./src/scripts/deleteBookFromDom.service.js");e.deleteBookFromLibrary=function(o){(0,t.$http)("POST","https://zoobooks-api.herokuapp.com/delete_book/"+o).then(function(e){(0,n.deleteBookFromDOM)(o)},function(o){(0,s.alertService)().raise({key:o.status})})}},"./src/scripts/dom.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.buttonHiddenStateToggle=function(o){o.classList.toggle("hidden")},e.headerMenuToggle=function(){zoobooks().elements().maintenance.classList.toggle("active")},e.headerMenuHide=function(){zoobooks().elements().maintenance.classList.remove("active")}},"./src/scripts/events.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.eventListeners=void 0;var t=r("./src/scripts/dom.service.js"),s=r("./src/scripts/alert.service.js"),n=r("./src/scripts/loader.service.js"),i=r("./src/scripts/addBookToLibrary.service.js"),a=r("./src/scripts/googleApisBookLookup.service.js"),c=function(o){if(o&&o.__esModule)return o;var e={};if(null!=o)for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);return e.default=o,e}(a),l=r("./src/scripts/ctrls.service.js"),d=r("./src/scripts/validation.service.js");e.eventListeners=function(){zoobooks().elements().header.ctrls.menuToggle.addEventListener("click",function(){(0,t.headerMenuToggle)()}),zoobooks().elements().books.addEventListener("click",function(){(0,t.headerMenuHide)()}),zoobooks().elements().forms.addBook.bookTitle.addEventListener("keyup",function(o){var e=/\w{1,}/,r=[];r.push(this.value),r.push(zoobooks().elements().forms.addBook.bookISBN.value),(0,d.validationService)().validate(r,e)?((0,l.ctrlsService)().enable(zoobooks().elements().forms.addBook.ctrls.findBookByISBN),(0,l.ctrlsService)().enable(zoobooks().elements().forms.addBook.ctrls.addBookToLibrary)):((0,l.ctrlsService)().disable(zoobooks().elements().forms.addBook.ctrls.findBookByISBN),(0,l.ctrlsService)().disable(zoobooks().elements().forms.addBook.ctrls.addBookToLibrary))}),zoobooks().elements().forms.addBook.bookISBN.addEventListener("keyup",function(o){var e=/\w{5,}/,r=[];r.push(this.value),r.push(zoobooks().elements().forms.addBook.bookTitle.value),(0,d.validationService)().validate(r,e)?((0,l.ctrlsService)().enable(zoobooks().elements().forms.addBook.ctrls.findBookByISBN),(0,l.ctrlsService)().enable(zoobooks().elements().forms.addBook.ctrls.addBookToLibrary)):((0,l.ctrlsService)().disable(zoobooks().elements().forms.addBook.ctrls.findBookByISBN),(0,l.ctrlsService)().disable(zoobooks().elements().forms.addBook.ctrls.addBookToLibrary))}),zoobooks().elements().forms.addBook.ctrls.createBook.addEventListener("click",function(){var o=Array.from(zoobooks().elements().forms.addBook.form.elements),e=!0,r=!1,t=void 0;try{for(var s,n=o[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){s.value.value=""}}catch(o){r=!0,t=o}finally{try{!e&&n.return&&n.return()}finally{if(r)throw t}}zoobooks().bookSearchAPI__SET(null),c.showBookInView()}),zoobooks().elements().forms.addBook.ctrls.addBookToLibrary.addEventListener("click",function(){var o=zoobooks().bookSearchAPI().results.length<1?null:zoobooks().bookSearchAPI().results.items[zoobooks().bookSearchAPI().currentBook];o?(o.volumeInfo.category=zoobooks().elements().forms.addBook.bookCategory.value,(0,i.addBookToLibrary)(o)):(0,s.alertService)().raise({key:"NO_DATA"})});var o=!0,e=!1,r=void 0;try{for(var a,u=zoobooks().categories()[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var k=a.value,m=document.createElement("OPTION");m.value=k,m.innerHTML=k,zoobooks().elements().forms.addBook.bookCategory.appendChild(m)}}catch(o){e=!0,r=o}finally{try{!o&&u.return&&u.return()}finally{if(e)throw r}}zoobooks().elements().forms.addBook.ctrls.nextBook.addEventListener("click",function(){var o=zoobooks().bookSearchAPI().currentBook;c.showBookInView(o+1)}),zoobooks().elements().forms.addBook.ctrls.previousBook.addEventListener("click",function(){var o=zoobooks().bookSearchAPI().currentBook;c.showBookInView(o-1)}),zoobooks().elements().forms.addBook.ctrls.findBookByISBN.addEventListener("click",function(o){var e=zoobooks().elements().forms.addBook.bookISBN.value.replace(/\-/g,""),r=zoobooks().elements().forms.addBook.bookTitle.value,t=zoobooks().elements().forms.addBook.bookAuthors.value;if(!e&&!r)return(0,s.alertService)().raise({key:"ISBN_OR_TITLE_REQUIRED"});(0,n.loader)().setLoading(),c.findBookByISBN(e,r,t).then(function(o){var i=JSON.parse(o);if(i.error||0==i.totalItems)(0,s.alertService)().raise({key:"BOOK_SEARCH_ERROR"}),(0,n.loader)().setLoaded();else{zoobooks().bookSearchAPI__SET({query:{isbn:e,title:r,author:t},results:i,currentBook:0}),zoobooks().importData__SET(a),console.log("zoobooks().bookSearchAPI()",zoobooks().bookSearchAPI()),console.log("zoobooks().importData()",zoobooks().importData());var a=zoobooks().bookSearchAPI().results.items[zoobooks().bookSearchAPI().currentBook];c.showBookInView(),(0,s.alertService)().raise({key:"BOOK_SEARCH_SUCCESS"}),(0,l.ctrlsService)().enable(zoobooks().elements().forms.addBook.ctrls.addBookToLibrary),(0,n.loader)().setLoaded()}},function(o){console.log(o)})})}()},"./src/scripts/googleApisBookLookup.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.showBookInView=e.findBookByISBN=void 0;var t=r("./src/scripts/http.service.js"),s=r("./src/scripts/alert.service.js");e.findBookByISBN=function(o,e,r){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{maxResults:40},n=s.maxResults||40,i="https://www.googleapis.com/books/v1/volumes?q=isbn:"+o+"&maxResults="+n,a="https://www.googleapis.com/books/v1/volumes?q="+e+" "+r+"&maxResults="+n;return new Promise(function(r,s){(0,t.$http)("GET",i).then(function(s){var n=JSON.parse(s);!o||0==n.totalItems&&e?(0,t.$http)("GET",a).then(function(o){r(o)},function(o){console.log(o)}):r(s)},function(o){s(o),console.log(o)})})},e.showBookInView=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=zoobooks().bookSearchAPI();if(console.log("data",e),e.results.items&&0!==e.results.items.length||(zoobooks().elements().forms.addBook.ctrls.totalItems.innerHTML="0 of 0",zoobooks().elements().forms.addBook.bookThumbnail.removeAttribute("src")),!e.results.items||o<0||o>=e.results.items.length)return(0,s.alertService)().raise({key:"OUT_OF_RANGE_ERROR"});e.currentBook=o,zoobooks().bookSearchAPI__SET(e);var r=zoobooks().bookSearchAPI().results.items[o],t=[r.volumeInfo.author||r.volumeInfo.authors||""],n=t.toString(),i=r.volumeInfo.google_thumbnail;i?zoobooks().elements().forms.addBook.bookThumbnail.classList.remove("missing"):zoobooks().elements().forms.addBook.bookThumbnail.classList.add("missing"),zoobooks().elements().forms.addBook.bookThumbnail.setAttribute("src",i),zoobooks().elements().forms.addBook.bookISBN.value=r.volumeInfo.isbn,zoobooks().elements().forms.addBook.bookTitle.value=r.volumeInfo.title,zoobooks().elements().forms.addBook.bookAuthors.value=n,zoobooks().elements().forms.addBook.ctrls.totalItems.innerHTML=zoobooks().bookSearchAPI().currentBook+1+" of "+zoobooks().bookSearchAPI().results.items.length}},"./src/scripts/http.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.$http=function(o,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return new Promise(function(s,n){var i=new XMLHttpRequest;i.onerror=function(o){var e=["ERR_CONNECTION_REFUSED","ERR_NAME_NOT_RESOLVED","ERR_BLOCKED_BY_CLIENT","ERR_TUNNEL_CONNECTION_FAILED"],r="The connection failed with one of the following errors: "+e.join("|");n({error:{info:r},info:"Could not determine the type of error. Please check the data property of this object for a list of possible errors",data:e})},i.open(o,e);var a=!0,c=!1,l=void 0;try{for(var d,u=t[Symbol.iterator]();!(a=(d=u.next()).done);a=!0){var k=d.value,m=k[0],b=k[1];i.setRequestHeader(m,b)}}catch(o){c=!0,l=o}finally{try{!a&&u.return&&u.return()}finally{if(c)throw l}}i.send(r),i.onreadystatechange=function(){if(i.status>=200&&i.status<400&&4==i.readyState)s(i.responseText);else if(4==i.readyState){var o={status:i.status};n(o)}}})}},"./src/scripts/loader.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.loader=function(){return function(){return{setLoading:function(){zoobooks().elements().loader.removeAttribute("hidden")},setLoaded:function(){zoobooks().elements().loader.setAttribute("hidden","hidden")}}}}()},"./src/scripts/main.js":function(o,e,r){"use strict";var t=r("./src/scripts/loader.service.js"),s=r("./src/scripts/addBookToDOM.service.js");if(location.search.match(/dev\=1/)){var n=document.querySelectorAll("[developeronly]"),i=!0,a=!1,c=void 0;try{for(var l,d=n[Symbol.iterator]();!(i=(l=d.next()).done);i=!0){l.value.removeAttribute("developeronly")}}catch(o){a=!0,c=o}finally{try{!i&&d.return&&d.return()}finally{if(a)throw c}}}var u={getBooks:"https://zoobooks-api.herokuapp.com/",addBook:"https://zoobooks-api.herokuapp.com/add_book/",deleteBook:"https://zoobooks-api.herokuapp.com/delete_book/"};(0,t.loader)().setLoading();var k=new XMLHttpRequest;k.open("GET",u.getBooks),k.send(),k.onload=function(){var o=JSON.parse(k.responseText);console.log(o);var e=!0,r=!1,n=void 0;try{for(var i,a=o[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var c=i.value;for(var l in c)c[l]=c[l]||"N/A";(0,s.addBookToDOM)(c)}}catch(o){r=!0,n=o}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}(0,t.loader)().setLoaded()}},"./src/scripts/models/book.model.js":function(o,e,r){"use strict";function t(o){var e=this;for(var r in o)e[r]=o[r];try{var t=Array.from(this.volumeInfo.industryIdentifiers),s=t.find(function(o){return"ISBN_13"==o.type}),n=s?s.identifier:t[0].identifier;e.volumeInfo.isbn=n}catch(o){e.volumeInfo.isbn=""}try{e.volumeInfo.google_thumbnail=e.volumeInfo.imageLinks.thumbnail}catch(o){e.volumeInfo.google_thumbnail=""}}Object.defineProperty(e,"__esModule",{value:!0}),e.Book=t},"./src/scripts/validation.service.js":function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.validationService=function(){return function(){return{validate:function(o,e){var r=!0,t=!1,s=void 0;try{for(var n,i=o[Symbol.iterator]();!(r=(n=i.next()).done);r=!0){if(n.value.match(e))return!0}}catch(o){t=!0,s=o}finally{try{!r&&i.return&&i.return()}finally{if(t)throw s}}return!1}}}}()},"./src/scripts/zoobooks.js":function(o,e,r){"use strict";var t=r("./src/scripts/models/book.model.js"),s=function(){var o={},e=["Communication","Agile & Tech","Customer Centricity","Leadership & Culture","Start-up & Entrepreneurial","Work & Wellbeing","Other"],r={query:{isbn:"",title:"",author:""},results:{items:[]},kind:"",totalItems:0},s=Object.assign({},r);return function(){return{categories:function(){return e},bookSearchAPI__SET:function(o){if(!o)return void(s=Object.assign({},r));var e=o.results.items.map(function(o){return new t.Book(o)});o.results.items=e;for(var n in o)s[n]=o[n]},bookSearchAPI:function(){return s},importData:function(){return o},importData__SET:function(e){o=e},elements:function(){return{loader:document.querySelector("#loader"),maintenance:document.querySelector("maintenance"),header:{ctrls:{menuToggle:document.querySelector("#ctrl__menuToggle")}},books:document.querySelector("books"),forms:{addBook:{form:document.querySelector("#form__addBook"),bookISBN:document.querySelector("[form__add-book__book-isbn]"),bookTitle:document.querySelector("[form__add-book__book-title]"),bookAuthors:document.querySelector("[form__add-book__book-authors]"),bookThumbnail:document.querySelector("[form__add-book__book-thumbnail]"),bookCategory:document.querySelector("[form__add-book__book-category]"),ctrls:{createBook:document.querySelector("#ctrl__createBook"),findBookByISBN:document.querySelector("#ctrl__findBookByISBN"),addBookToLibrary:document.querySelector("#ctrl__addBookToLibrary"),totalItems:document.querySelector("[form__add-book__ctrls__total-items]"),nextBook:document.querySelector("[form__add-book__ctrls__next-book]"),previousBook:document.querySelector("[form__add-book__ctrls__previous-book]")}}}}}}}}();window.zoobooks=s},"./src/styles/main.scss":function(o,e){},0:function(o,e,r){o.exports=r("./src/index.js")}},[0]);